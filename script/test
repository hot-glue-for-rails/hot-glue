#!/bin/bash

clean_generated_code() {
./clean_generated_code
}

echo "test-on-test suite for Hot Glue..."

# note that the dummy/ is in the root of the repository

cd dummy

echo "setting up database..."

bundle install

rake db:create db:reset db:test:prepare

echo "Generating Abcs with rails generate hot_glue:scaffold Abc --gd"
rails generate hot_glue:scaffold Abc --gd

# problem: I think I need to re-load the app here so that the newly generated code gets picked up


bin/rake spec || exit

cd ../

script/clean_generated_code

