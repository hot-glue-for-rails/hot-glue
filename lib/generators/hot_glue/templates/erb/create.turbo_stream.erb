<\% if @<%= singular %>.errors.none? %>
  <\%= turbo_stream.replace "<%= @namespace %>__<%= plural %>-list" + <%= nested_for_turbo_nested_constructor %> do %>
  <\%= render partial: "list", locals: {<%= plural %>: @<%= plural %>}<%= @within_set.collect{|arg| ".merge(@" + arg[:singular] + " ? {nested_for: \"" + arg[:singular] + "-\#{@" + arg[:singular] + ".id}\"" + ", " + arg[:singular] + ": @" + arg[:singular] + "} : {})"}.join()  %> \%>
  <\% end %>
  <\% end %>
<%= turbo_parental_updates %>
  <\%= turbo_stream.replace "<%= @namespace %>__<%= singular %>-new" do %>
  <\% if @<%= singular %>.errors.none? %>
  <\%= render partial: "new_button", locals: {}<%=  @within_set.collect{|arg| ".merge(@" + arg[:singular] + " ? {" + arg[:singular] + ": @" + arg[:singular] + "} : {})"}.join()  %> %>
  <\% else %>
  <\%= render partial: "new_form", locals: {<%= singular %>: @<%= singular %>}<%=  @within_set.collect{|arg| ".merge(@" + arg[:singular] + " ? {" + arg[:singular] + ": @" + arg[:singular] + "} : {})"}.join()  %> %>
  <\% end %>
  <\% end %>
  <\%= turbo_stream.replace "flash_notices" do %>
  <\%= render partial: "layouts/flash_notices", locals: {resource: @<%= singular %>} %>

<\% end %>
